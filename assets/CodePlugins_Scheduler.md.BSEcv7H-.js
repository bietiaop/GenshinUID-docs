import{_ as p}from"./chunks/PageInfo.vue_vue_type_script_setup_true_lang.B2ROFaZv.js";import{_ as t}from"./chunks/Badge.Gth0UqrR.js";import{_ as l,c as h,j as a,a as s,I as i,a4 as k,o as r}from"./chunks/framework.AIsPoTDm.js";import"./chunks/theme.BQQaTOTO.js";const C=JSON.parse('{"title":"定时任务","description":"","frontmatter":{},"headers":[],"relativePath":"CodePlugins/Scheduler.md","filePath":"CodePlugins/Scheduler.md","lastUpdated":1723983137000}'),d={name:"CodePlugins/Scheduler.md"},E={id:"定时任务",tabindex:"-1"},c=a("a",{class:"header-anchor",href:"#定时任务","aria-label":'Permalink to "定时任务<Badge type="tip" text="普通" />"'},"​",-1),o=k(`<div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> gsuid_core.aps </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> scheduler</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> gsuid_core.gss </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> gss</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">@scheduler.scheduled_job</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;cron&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">minute</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;*/30&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#设定一个定时任务、每隔三十分钟执行一次</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> notice_job</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">():</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	im </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> process(name)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 自己的业务逻辑</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	for</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> BOT_ID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> gss.active_bot: </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 获取全部连接中的Bot，注意，这里的BOT_ID和bot_id并不等价</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		bot </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> gss.active_bot[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">BOT_ID</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 拿到bot实例</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> bot.target_send(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            msg,       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 具体要发送的消息</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &#39;direct&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 发送方式group或者direct</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            target_id, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 发送目标，群号或者用户id，str</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            bot_id,    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 实际bot_id、和上面的BOT_id不同，例如onebot等等</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &#39;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,        </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># bot_self_id, 用于同平台多bot连接，例如bot自己的QQ号等，可空</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &#39;&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">		   # msg_id,要回复的某一个msg的id，可空</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            at_sender, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 是否要at发送者，默认False</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            sender_id, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># sender_id, 默认为空，主动发送时，不建议填写这两个选项</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        )</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div>`,1);function g(y,_,b,m,u,D){const n=t,e=p;return r(),h("div",null,[a("h1",E,[s("定时任务"),i(n,{type:"tip",text:"普通"}),s(),c]),i(e,{readTime:"1",words:"206"}),o])}const T=l(d,[["render",g]]);export{C as __pageData,T as default};
